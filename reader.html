<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta charset="UTF-8">
<title>é˜…è¯»å™¨</title>
<style>
body { background:#111; color:#0f0; font-family: monospace; margin:20px; }
button { margin:5px; padding:8px 12px; background:#111; color:#0f0; border:1px solid #0f0; cursor:pointer; border-radius:5px; }
button:hover { background:#0f0; color:#111; }
#bookContent { white-space: pre-wrap; margin-top:20px; border:1px solid #0f0; padding:10px; height:300px; overflow:auto; }
</style>
</head>
<body>
<button onclick="goBack()">â¬… è¿”å›ç›®å½•</button>
<h1 id="title">åŠ è½½ä¸­...</h1>
<div id="bookContent">...</div>
<br>
<button onclick="toggleAudio()">ğŸ”Š æ’­æ”¾/æš‚åœè¯­éŸ³</button>

<script>
const params = new URLSearchParams(window.location.search);
const bookId = params.get('book');
const chapterNum = params.get('chapter');

const contentDiv = document.getElementById('bookContent');
const titleDiv = document.getElementById('title');

let audio = null;

// è¿”å›ç›®å½•
function goBack(){
    window.location.href = `library.html?book=${bookId}`;
}

// åŠ è½½ç« èŠ‚æ–‡å­—
if(bookId && chapterNum){
    const txtFile = `assets/${bookId}/chapter${chapterNum}.txt`;
    fetch(txtFile)
    .then(res => res.text())
    .then(text => {
        contentDiv.textContent = text;
        titleDiv.textContent = `${bookId} ç¬¬${chapterNum}ç« `;
    })
    .catch(()=>{ contentDiv.textContent = "âŒ ç« èŠ‚å†…å®¹åŠ è½½å¤±è´¥"; });

    // åŠ è½½éŸ³é¢‘
    audio = new Audio(`assets/${bookId}/chapter${chapterNum}.mp3`);
} else {
    contentDiv.textContent = "âŒ å‚æ•°é”™è¯¯ï¼Œæœªæ‰¾åˆ°ç« èŠ‚";
    titleDiv.textContent = "é”™è¯¯";
}

// æ’­æ”¾/æš‚åœéŸ³é¢‘
function toggleAudio(){
    if(audio){
        if(audio.paused) audio.play();
        else audio.pause();
    }
}
</script>
</body>
</html>
